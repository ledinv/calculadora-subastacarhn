<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detalle del Vehículo | SubastaCarHN</title>
  <link rel="manifest" href="Img/site.webmanifest">
  <link rel="apple-touch-icon" sizes="180x180" href="Img/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="Img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="Img/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="192x192" href="Img/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="Img/android-chrome-512x512.png">
  <meta name="theme-color" content="#002f6c">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="estilos.css">
</head>
<body>

<!-- HEADER -->
<header>
  <div class="container header-inner">
    <a href="index.html" class="brand">SubastaCarHN</a>
    <nav class="nav-links" aria-label="Menú principal">
      <a href="calculadora.html">Calculadora</a>
      <a href="inventario.html">Automóviles</a>
      <a href="#cursos" id="linkCursos">Cursos</a>
      <span id="userGreeting"></span>
    </nav>
    <button class="menu-icon" aria-label="Abrir menú" onclick="toggleMenu()">☰</button>
  </div>

  <ul id="mobile-menu-links" class="mobile-nav" aria-label="Menú móvil">
    <li><a href="calculadora.html">Calculadora</a></li>
    <li><a href="inventario.html">Automóviles</a></li>
    <li><a href="#cursos" id="linkCursosMobile">Cursos</a></li>
    <li><span id="mobileGreeting"></span></li>
    <li><a href="https://wa.me/50497330137" target="_blank">WhatsApp</a></li>
  </ul>
</header>

<!-- CONTENIDO PRINCIPAL -->
<section class="container" id="detalleVehiculo" style="margin-top: 3rem; text-align: center;">
  <!-- Aquí cargará el vehículo -->
</section>

<!-- SUGERENCIAS -->
<section class="container" id="sugerencias" style="margin-top: 4rem;">
  <h2 style="text-align:center;">También te puede interesar</h2>
  <div id="autosSugeridos" style="display:grid; gap:2rem; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); margin-top:2rem;"></div>
</section>

<!-- FOOTER -->
<footer>
  <div class="container">
    <div>SubastaCarHN — Importaciones claras, seguras y al mejor precio</div>
    <div style="margin-top:0.5rem;">
      <a href="https://www.facebook.com/people/Subasta-Car-HN/100090605243085/" target="_blank">Facebook</a> |
      <a href="https://www.instagram.com/subastacar1/" target="_blank">Instagram</a> |
      <a href="https://www.tiktok.com/@tu_amigo_el_importador" target="_blank">TikTok</a>
    </div>
  </div>
</footer>

<!-- Firebase + Scripts -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script>
// Firebase config igual a tus otros archivos
const firebaseConfig = {
  apiKey: "AIzaSyA5BuOwgEUYK1JMwJD0PL0k0rcAST_Koms",
  authDomain: "subastacarhn-40554.firebaseapp.com",
  projectId: "subastacarhn-40554",
  storageBucket: "subastacarhn-40554.appspot.com",
  messagingSenderId: "536785797974",
  appId: "1:536785797974:web:e3eabb4dcd898c2ffe8cf7",
  measurementId: "G-QM5N60K8C0"
};
firebase.initializeApp(firebaseConfig);

// Menú móvil
function toggleMenu() {
  const menu = document.getElementById('mobile-menu-links');
  menu.style.display = menu.style.display === 'flex' ? 'none' : 'flex';
}

// Autenticación usuario
firebase.auth().onAuthStateChanged(user => {
  const desktop = document.getElementById('userGreeting');
  const mobile  = document.getElementById('mobileGreeting');
  if (user) {
    const name = (user.displayName || user.email.split('@')[0])
                   .replace(/^./, c => c.toUpperCase());
    desktop.innerHTML = `<a href="perfil.html">Hola, ${name}</a> &nbsp;|&nbsp; <a href="#" onclick="logout()">Cerrar sesión</a>`;
    mobile.innerHTML  = `<a href="perfil.html">Hola, ${name}</a> &nbsp;|&nbsp; <a href="#" onclick="logout()">Salir</a>`;
  } else {
    desktop.innerHTML = `<a href="login.html">Iniciar sesión</a> | <a href="register.html">Registrarse</a>`;
    mobile.innerHTML  = desktop.innerHTML;
  }
});

function logout() {
  firebase.auth().signOut().then(() => location.reload());
}
</script>

<script>
// Script para cargar el vehículo
async function cargarVehiculo() {
  const params = new URLSearchParams(window.location.search);
  const id = params.get('id');

  if (!id) {
    document.getElementById('detalleVehiculo').innerHTML = '<p>Vehículo no encontrado.</p>';
    return;
  }

  try {
    const res = await fetch('inventario.json');
    const inventario = await res.json();
    const auto = inventario.find(a => a.id === id);

    if (!auto) {
      document.getElementById('detalleVehiculo').innerHTML = '<p>Vehículo no disponible.</p>';
      return;
    }

    document.getElementById('detalleVehiculo').innerHTML = `
      <img src="${auto.imagen}" alt="${auto.modelo}" style="width:100%; max-width:600px; height:auto; border-radius:12px;">
      <h1 style="margin-top:1rem;">${auto.marca} ${auto.modelo} ${auto.anio}</h1>
      <p style="font-size:1.2rem; color:var(--blue); font-weight:700;">L ${auto.precio.toLocaleString()}</p>
      <p><strong>Color:</strong> ${auto.color}</p>
      <p><strong>Tipo:</strong> ${auto.tipo}</p>
      <p><strong>Kilometraje:</strong> ${auto.kilometraje.toLocaleString()} km</p>
      <p style="margin:2rem 0;">${auto.descripcion}</p>
      <a href="https://wa.me/50497330137?text=Hola,%20estoy%20interesado%20en%20el%20${auto.marca}%20${auto.modelo}%20${auto.anio}" class="styled-btn" style="margin-top:1rem;">Consultar por WhatsApp</a>
    `;

    mostrarSugerencias(inventario, auto);

  } catch (error) {
    console.error('Error al cargar vehículo:', error);
  }
}

function mostrarSugerencias(inventario, actual) {
  const sugerencias = inventario.filter(a => a.marca === actual.marca && a.id !== actual.id).slice(0, 3);
  const contenedor = document.getElementById('autosSugeridos');
  sugerencias.forEach(auto => {
    const div = document.createElement('div');
    div.style.border = '1px solid #ccc';
    div.style.borderRadius = '8px';
    div.style.padding = '1rem';
    div.style.background = '#fff';
    div.style.cursor = 'pointer';
    div.innerHTML = `
      <img src="${auto.imagen}" alt="${auto.modelo}" style="width:100%; height:200px; object-fit:cover; border-radius:8px;">
      <h3 style="margin:0.5rem 0;">${auto.marca} ${auto.modelo} ${auto.anio}</h3>
      <p style="font-weight:700; color:var(--blue);">L ${auto.precio.toLocaleString()}</p>
    `;
    div.addEventListener('click', () => {
      window.location.href = `vehiculo.html?id=${auto.id}`;
    });
    contenedor.appendChild(div);
  });
}

cargarVehiculo();
</script>

</body>
</html>
