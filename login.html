<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Iniciar Sesión – SubastaCarHN</title>
  <link rel="manifest" href="Img/site.webmanifest">
  <link rel="apple-touch-icon" sizes="180x180" href="Img/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="Img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="Img/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="192x192" href="Img/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="Img/android-chrome-512x512.png">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="Img/favicon-32x32.png">
  <meta name="theme-color" content="#002f6c">
  <style>
    /* --- Tus estilos aquí (idénticos a register.html) --- */
    body { font-family: Helvetica, sans-serif; margin:0; padding:0; background:#f9f9f9; }
    header { background:linear-gradient(to right,#002f6c,#004aad); height:70px; display:flex; align-items:center; justify-content:space-between; padding:0 15px; position:sticky; top:0; z-index:999; }
    header a.brand { color:white; font-size:22px; font-weight:bold; text-decoration:none; margin:0 auto; }
    .menu-icon { font-size:20px; background:#ffc20e; color:#002f6c; padding:8px 10px; border-radius:6px; cursor:pointer; font-weight:bold; box-shadow:0 2px 8px rgba(0,0,0,0.3); }
    #menu-links { display:none; list-style:none; padding:10px; margin:10px 0 0; background:white; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.2); position:absolute; top:70px; left:15px; z-index:1000; }
    #menu-links li { margin-bottom:10px; }
    #menu-links a { text-decoration:none; color:#002f6c; font-weight:bold; }
    .layout { display:flex; justify-content:center; align-items:center; padding:40px 10px; }
    .contenido-central { width:100%; max-width:400px; background:white; border-radius:15px; box-shadow:0 4px 12px rgba(0,0,0,0.08); padding:20px; }
    .contenido-central h1 { text-align:center; color:#002f6c; margin-bottom:20px; }
    label { font-weight:bold; color:#002f6c; display:block; margin-top:10px; }
    input { font-size:14px; padding:8px; border-radius:8px; border:1px solid #004aad; background:#f0f8ff; width:100%; margin-top:5px; box-sizing:border-box; }
    .styled-btn { background:#ffc20e; color:#002f6c; font-weight:bold; border:none; border-radius:8px; padding:10px; margin-top:20px; width:100%; cursor:pointer; font-size:15px; box-shadow:0 2px 5px rgba(0,0,0,0.2); }
    .styled-btn:hover { background:#e6ac00; }
    .forgot { text-align:center; margin-top:10px; }
    .forgot a { color:#004aad; text-decoration:underline; font-size:0.9rem; }
    .modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); align-items:center; justify-content:center; z-index:1000; }
    .modal-content { background:white; padding:1.5rem; border-radius:8px; max-width:400px; width:90%; position:relative; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
    .modal-content .close { position:absolute; top:0.5rem; right:1rem; font-size:1.5rem; cursor:pointer; }
  </style>
</head>
<body>
  <header>
    <div class="menu-icon" onclick="toggleMenu()">☰</div>
    <a href="index.html" class="brand">SUBASTACARHN</a>
    <span></span>
  </header>
  <ul id="menu-links">
    <li><a href="https://www.facebook.com/…">Facebook</a></li>
    <li><a href="https://www.instagram.com/…">Instagram</a></li>
    <li><a href="https://www.tiktok.com/…">TikTok</a></li>
    <li><a href="https://wa.me/50497330137">WhatsApp</a></li>
  </ul>

  <div class="layout">
    <div class="contenido-central">
      <h1>Iniciar Sesión</h1>
      <form id="loginForm">
        <label for="emailL">Correo electrónico</label>
        <input type="email" id="emailL" required />

        <label for="passwordL">Contraseña</label>
        <input type="password" id="passwordL" minlength="8" required />

        <button type="submit" class="styled-btn">Entrar</button>

        <p class="forgot">
          <a href="#" id="forgot-link">¿Olvidaste tu contraseña?</a>
        </p>
      </form>
      <p style="text-align:center; margin-top:15px;">
        ¿No tienes cuenta? <a href="register.html">Registrarse</a>
      </p>
    </div>
  </div>

  <!-- Modal Recuperación -->
  <div id="resetModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Recuperar contraseña</h2>
      <form id="reset-form">
        <label for="reset-email">Correo electrónico</label>
        <input type="email" id="reset-email" required />
        <button type="submit" class="styled-btn">Enviar enlace</button>
      </form>
      <p id="reset-msg" style="text-align:center; margin-top:10px;"></p>
    </div>
  </div>

  <!-- Firebase compat SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script>
    // Configuración Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyA5BuOwgEUYK1JMwJD0PL0k0rcAST_Koms",
      authDomain: "subastacarhn-40554.firebaseapp.com",
      projectId: "subastacarhn-40554",
      storageBucket: "subastacarhn-40554.firebasestorage.app",
      messagingSenderId: "536785797974",
      appId: "1:536785797974:web:e3eabb4dcd898c2ffe8cf7",
      measurementId: "G-QM5N60K8C0"
    };
    <script>
  // Configuración Firebase (lo de arriba queda igual)
  firebase.initializeApp(firebaseConfig);

  window.addEventListener('DOMContentLoaded', () => {
    // — LOGIN —
    document.getElementById('loginForm').addEventListener('submit', async e => {
      e.preventDefault();
      const email = document.getElementById('emailL').value.trim();
      const pass  = document.getElementById('passwordL').value;
      try {
        // 1) Inicia sesión
        await firebase.auth().signInWithEmailAndPassword(email, pass);

        // 2) Forzamos una recarga del objeto currentUser
        await firebase.auth().currentUser.reload();

        // 3) Sacamos el usuario actualizado
        const user = firebase.auth().currentUser;

        // 4) Si no está verificado, cortamos aquí
        if (!user.emailVerified) {
          alert('⚠️ Verifica tu correo antes de continuar.');
          return;
        }

        // 5) Si todo ok, redirigimos
        window.location.href = 'index.html';

      } catch(err) {
        const msg = (err.code==='auth/user-not-found' || err.code==='auth/wrong-password')
          ? '⚠️ Email o contraseña incorrectos.'
          : err.message;
        alert(msg);
      }
    });

    // — RECUPERAR CONTRASEÑA — (lo tuyo queda igual)
    …
  });
</script>


      // — RECUPERAR CONTRASEÑA —
      const forgotLink = document.getElementById('forgot-link');
      const modal      = document.getElementById('resetModal');
      const closeBtn   = modal.querySelector('.close');
      const resetForm  = document.getElementById('reset-form');
      const resetMsg   = document.getElementById('reset-msg');

      forgotLink.addEventListener('click', e => {
        e.preventDefault();
        resetForm.reset();
        resetMsg.textContent = '';
        modal.style.display = 'flex';
      });
      closeBtn.addEventListener('click', () => modal.style.display = 'none');
      window.addEventListener('click', e => {
        if (e.target === modal) modal.style.display = 'none';
      });
      resetForm.addEventListener('submit', async e => {
        e.preventDefault();
        const email = document.getElementById('reset-email').value.trim();
        try {
          await firebase.auth().sendPasswordResetEmail(email);
          resetMsg.textContent = `✅ Enviado enlace a ${email}. Revisa tu bandeja.`;
        } catch(err) {
          if (err.code==='auth/user-not-found')      resetMsg.textContent = '❌ Cuenta no encontrada.';
          else if (err.code==='auth/invalid-email')  resetMsg.textContent = '❌ Correo inválido.';
          else                                       resetMsg.textContent = '❌ Error al enviar el correo.';
        }
      });
    });
  </script>
</body>
</html>
