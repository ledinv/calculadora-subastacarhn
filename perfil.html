<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mi Perfil – SubastaCarHN</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet" />
  <meta name="theme-color" content="#002f6c" />
  <style>
    :root {
      --blue: #002f6c;
      --blue2: #004aad;
      --yellow: #ffc20e;
      --text: #333;
      --light: #f9f9f9;
      --shadow: rgba(0,0,0,0.1);
      --max-width: 1200px;
      --card-radius: 8px;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Montserrat', sans-serif; background: var(--light); color: var(--text); line-height: 1.6; }
    a { text-decoration: none; color: inherit; }
    .container { max-width: var(--max-width); margin: 0 auto; padding: 1rem; }

    /* Header original */
    .site-header {
      background: linear-gradient(to right, var(--blue), var(--blue2));
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    .header-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.75rem;
    }
    .brand { color: #fff; font-size: 1.5rem; font-weight: 700; }
    .nav-list {
      display: flex;
      gap: 1rem;
      margin-left: auto;
    }
    .nav-list a, .nav-list span {
      color: var(--yellow);
      font-weight: 600;
      font-size: 0.95rem;
    }
    .menu-icon {
      background: var(--yellow);
      color: var(--blue);
      border: none;
      padding: 0.5rem;
      border-radius: 6px;
      cursor: pointer;
      box-shadow: 0 2px 8px var(--shadow);
    }
    .mobile-nav {
      display: none;
      flex-direction: column;
      background: #fff;
      padding: 1rem;
      box-shadow: 0 2px 8px var(--shadow);
    }
    .mobile-nav.open { display: flex; gap: 0.5rem; }
    .mobile-nav a, .mobile-nav span {
      font-weight: 700;
      padding: 0.75rem;
      border-radius: 4px;
      transition: background 0.2s;
      color: var(--blue);
    }
    .mobile-nav a:hover, .mobile-nav span:hover { background: rgba(0,47,108,0.1); }
    @media (max-width: 767px) { .nav-list { display: none; } }
    @media (min-width: 768px) { .menu-icon { display: none; } }

    /* Tabs */
    .tabs { display: flex; border-bottom: 2px solid var(--blue2); margin-bottom: 1rem; }
    .tab { flex: 1; text-align: center; padding: 0.75rem; cursor: pointer; background: var(--blue2); color: #fff; font-weight: 600; }
    .tab.active { background: var(--blue); }
    .section { display: none; }
    .section.active { display: block; }

    /* Cards */
    .card { background: #fff; border-radius: var(--card-radius); box-shadow: 0 2px 8px var(--shadow); margin-bottom: 1rem; overflow: hidden; }
    .card-header { background: var(--blue2); color: #fff; padding: 0.75rem 1rem; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
    .card-body { max-height: 0; overflow: hidden; transition: max-height 0.3s ease, padding 0.3s ease; padding: 0 1rem; }
    .card-body.open { padding: 1rem; max-height: 800px; }
    .status-badge { background: var(--yellow); color: var(--text); padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; }

    .btn { background: var(--yellow); color: var(--blue); border: none; padding: 0.75rem 1rem; border-radius: var(--card-radius); cursor: pointer; font-weight: 600; }
    form .grid { display: grid; gap: 0.75rem; }
    .grid-2 { grid-template-columns: 1fr 1fr; }
    input, select, textarea { width: 100%; padding: 0.6rem; border: 1px solid #ccc; border-radius: 4px; }

    .tracker { list-style: none; display: flex; gap: 0.5rem; flex-wrap: wrap; padding: 0; margin-bottom: 1rem; }
    .tracker li { position: relative; padding-left: 1.2rem; font-size: 0.8rem; }
    .tracker li::before { content: ''; position: absolute; left: 0; top: 0.2rem; width: 0.8rem; height: 0.8rem; border-radius: 50%; background: #ccc; }
    .tracker li.done::before { background: var(--yellow); }
    .tracker li.active::before { background: var(--blue); }

    .orders-grid { display: grid; gap: 1rem; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); }
    /* Historial scroll */
    #historialContainer { max-height: 400px; overflow-y: auto; padding-right: 0.5rem; }
    #historialContainer .card { margin-bottom: 0.5rem; }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="brand">SubastaCarHN</a>
      <ul class="nav-list">
        <li><a href="index.html">Inicio</a></li>
        <li><a href="calculadora.html">Calculadora</a></li>
        <li><a href="inventario.html">Vehículos</a></li>
        <li><a href="cursos.html">Cursos</a></li>
        <li><span id="userGreeting"></span></li>
      </ul>
      <button class="menu-icon" onclick="toggleMenu()">☰</button>
    </div>
    <nav id="mobile-menu-links" class="mobile-nav">
      <a href="index.html">Inicio</a>
      <a href="calculadora.html">Calculadora</a>
      <a href="inventario.html">Vehículos</a>
      <a href="cursos.html">Cursos</a>
      <span id="mobileGreeting"></span>
    </nav>
  </header>

  <main class="container">
    <div class="tabs">
      <div class="tab active" data-sec="perfil">Perfil</div>
      <div class="tab" data-sec="gestion">Gestión</div>
      <div class="tab" data-sec="historial">Historial</div>
    </div>

    <section id="section-perfil" class="section active">
      <div class="card">
        <div class="card-header">Mi Perfil</div>
        <div class="card-body open">
          <form id="profileForm" class="grid grid-2">
            <label>Nombre<input type="text" id="name" required></label>
            <label>Email<input type="email" id="email" readonly></label>
            <label>Teléfono<input type="tel" id="phone" readonly></label>
            <label>Dirección<input id="address"></label>
            <label>DNI<input id="dni"></label>
            <label>Año nacimiento<input type="number" id="birthYear" min="1900" max="2100"></label>
            <div></div>
            <button type="submit" class="btn">Guardar</button>
            <button type="button" class="btn" onclick="sendPasswordReset()">Cambiar contraseña</button>
            <button type="button" class="btn" onclick="logout()">Cerrar sesión</button>
          </form>
        </div>
      </div>
    </section>

    <section id="section-gestion" class="section">
      <div class="card">
        <div class="card-header">Nueva Gestión</div>
        <div class="card-body open grid">
          <button id="btnStartGestion" class="btn">Comenzar gestión (5,000 LPS)</button>
          <div id="depositForm" style="display:none;" class="grid grid-2">
            <input type="file" id="depositFile" accept="application/pdf,image/*">
            <button id="btnUploadDeposit" class="btn">Enviar comprobante</button>
          </div>
          <div id="depositSuccess" class="card-body open" style="display:none;">✅ Comprobante subido</div>
        </div>
      </div>
      <h2>Mis Gestiones</h2>
      <div id="orders" class="orders-grid"></div>
    </section>

    <section id="section-historial" class="section">
      <h2>Historial de Cálculos</h2>
      <div id="historialContainer"></div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <nav class="footer-nav">
        <ul class="footer-list">
          <li><a href="index.html">Inicio</a></li>
          <li><a href="calculadora.html">Calculadora</a></li>
          <li><a href="inventario.html">Vehículos</a></li>
          <li><a href="cursos.html">Cursos</a></li>
        </ul>
      </nav>
      <div class="social-links">
        <a href="https://facebook.com/Subasta-Car-HN" target="_blank">Facebook</a> |
        <a href="https://instagram.com/subastacar1" target="_blank">Instagram</a> |
        <a href="https://tiktok.com/@tu_amigo_el_importador" target="_blank">TikTok</a>
      </div>
      <div class="footer-copy">© 2025 SubastaCarHN. Todos los derechos reservados.</div>
    </div>
  </footer>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>
  <script>
    firebase.initializeApp({
      apiKey: "AIzaSyA5BuOwgEUYK1JMwJD0PL0k0rcAST_Koms",
      authDomain: "subastacarhn-40554.firebaseapp.com",
      projectId: "subastacarhn-40554",
      storageBucket: "subastacarhn-40554.appspot.com",
      messagingSenderId: "536785797974",
      appId: "1:536785797974:web:e3eabb4dcd898c2ffe8cf7",
